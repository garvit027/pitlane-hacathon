/* --- Base Chat Container --- */
.chat-container {
  display: flex;
  flex-direction: column;
  height: 100%; /* Fill the available space in the tab */
  max-height: 100%; /* Prevent exceeding parent height */
  background: rgba(10, 12, 15, 0.7); /* Slightly darker chat background */
  border-radius: 8px; /* Match panel rounding */
  overflow: hidden; /* Important for layout */
  color: #ccc;
  border: 1px solid rgba(255, 255, 255, 0.05); /* Subtle border */
}

/* --- Chat Header --- */
.chat-header {
  padding: 15px 20px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  flex-shrink: 0; /* Prevent header shrinking */
  background: rgba(25, 30, 40, 0.6);
}
.chat-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.chat-title h3 {
  font-family: 'Aldrich', sans-serif;
  color: #eee;
  font-size: 1.3em;
  margin: 0;
}
.connection-status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.8em;
  font-weight: bold;
  padding: 3px 8px;
  border-radius: 10px;
  text-transform: uppercase;
}
.connection-status .status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}
.connection-status .connected { color: #10b981; background: rgba(16, 185, 129, 0.15); }
.connection-status .connected .status-dot { background: #10b981; animation: pulse-green 1.5s infinite ease-in-out; }
.connection-status .disconnected { color: #f59e0b; background: rgba(245, 158, 11, 0.15); }
.connection-status .disconnected .status-dot { background: #f59e0b; }

@keyframes pulse-green {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.2); opacity: 0.7; }
}

.chat-info {
  display: flex;
  gap: 15px;
  font-size: 0.8em;
  color: #888;
}
.online-count, .message-count, .current-user { /* Styles if needed */ }
.current-user { font-weight: bold; color: #aaa; }


/* --- Messages Area --- */
.messages-container {
  flex-grow: 1; /* Take remaining vertical space */
  overflow-y: auto; /* Enable scrolling for messages */
  padding: 15px 20px;
  display: flex;
  flex-direction: column;
  gap: 12px; /* Space between messages */
}

/* No Messages Placeholder */
.no-messages {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  color: #666;
  padding: 40px;
}
.no-messages-icon { font-size: 3em; margin-bottom: 15px; opacity: 0.5; }
.no-messages h4 { color: #888; margin-bottom: 10px; }
.no-messages p { font-size: 1em; margin-bottom: 20px; }
.chat-tips { display: flex; flex-direction: column; gap: 8px; font-size: 0.9em; }
.tip { color: #555; }


/* Individual Message Styling */
.message {
  display: flex;
  gap: 12px;
  max-width: 85%; /* Prevent messages taking full width */
  align-items: flex-start; /* Align avatar with top of message */
  position: relative; /* For actions */
}
.message-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background-color: #444; /* Default */
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  flex-shrink: 0;
  margin-top: 2px; /* Align slightly better with text */
  font-size: 1.1em;
}

.message-content {
  background-color: rgba(40, 45, 55, 0.7); /* Message bubble background */
  padding: 10px 15px;
  border-radius: 12px;
  border-top-left-radius: 0; /* Point towards avatar */
  flex-grow: 1;
}
.message-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 5px;
}
.user-name {
  font-weight: bold;
  color: #eee;
  font-size: 0.9em;
}
.timestamp {
  font-size: 0.75em;
  color: #777;
}
.message-text {
  font-size: 1em;
  line-height: 1.5;
  word-wrap: break-word; /* Wrap long words */
}
.message-text a.message-link {
    color: #8892ff;
    text-decoration: underline;
    word-break: break-all; /* Break long URLs */
}
.message-text a.message-link:hover {
    color: #a3aaff;
}


/* Own Message Styling */
.message.own-message {
  margin-left: auto; /* Push to the right */
  flex-direction: row-reverse; /* Avatar on the right */
}
.message.own-message .message-content {
  background-color: rgba(100, 108, 255, 0.3); /* User's bubble color */
  border-top-left-radius: 12px;
  border-top-right-radius: 0; /* Point towards avatar */
}
.message.own-message .user-name {
  color: #a3aaff; /* Highlight own username slightly */
}

/* Message Actions (Quick React on Hover) */
.message-actions {
  position: absolute;
  top: -15px; /* Position above the bubble */
  right: 10px; /* Adjust as needed */
  background: #1e222a;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 20px;
  padding: 4px 6px;
  display: flex;
  gap: 5px;
  opacity: 0;
  transition: opacity 0.2s ease-out, transform 0.2s ease-out;
  transform: translateY(5px);
  pointer-events: none;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
.message:hover .message-actions {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}
.quick-react {
  background: none;
  border: none;
  font-size: 1.1em;
  cursor: pointer;
  padding: 2px;
  transition: transform 0.1s ease-out;
}
.quick-react:hover {
  transform: scale(1.3);
}
/* Hide actions for own messages */
.message.own-message .message-actions {
    display: none;
}


/* Message Reactions */
.message-reactions {
  margin-top: 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}
.reaction-bubble {
  background: rgba(100, 108, 255, 0.2);
  border: 1px solid rgba(100, 108, 255, 0.4);
  color: #eee;
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 0.8em;
  cursor: pointer; /* Can allow removing reaction */
  transition: background 0.2s;
}
.reaction-bubble:hover {
  background: rgba(100, 108, 255, 0.3);
}

/* --- Input Form --- */
.message-input-form {
  padding: 15px 20px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(13, 17, 23, 0.7);
  flex-shrink: 0;
}
.input-container {
  display: flex;
  gap: 10px;
  align-items: center;
  position: relative; /* For GIF picker positioning */
}
.message-input {
  flex-grow: 1;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #444;
  border-radius: 20px; /* Pill shape */
  padding: 10px 15px;
  font-size: 1em;
  color: #eee;
  outline: none;
}
.message-input:focus {
  border-color: #646cff;
}
.message-input:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.send-button {
  background: #646cff;
  color: white;
  border: none;
  border-radius: 20px;
  padding: 10px 20px;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.2s;
}
.send-button:hover:not(:disabled) {
  background: #535bf2;
}
.send-button:disabled {
  background: #444;
  cursor: not-allowed;
  opacity: 0.6;
}

.gif-toggle {
  background: none;
  border: none;
  font-size: 1.5em;
  padding: 5px;
  cursor: pointer;
  color: #888;
  transition: color 0.2s;
}
.gif-toggle:hover { color: #ccc; }

.gif-picker {
  position: absolute;
  bottom: calc(100% + 5px); /* Position above input */
  left: 0;
  width: calc(100% - 120px); /* Adjust width */
  max-height: 150px;
  overflow-y: auto;
  background: #1e222a;
  border: 1px solid #444;
  border-radius: 8px;
  padding: 10px;
  box-shadow: 0 -5px 15px rgba(0,0,0,0.3);
  z-index: 10;
}
.gif-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}
.gif-option {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  font-size: 1.5em;
  padding: 5px;
  border-radius: 5px;
  cursor: pointer;
}
.gif-option:hover { background: rgba(255, 255, 255, 0.2); }

.input-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
  font-size: 0.8em;
  color: #777;
}
.char-count { /* Style if needed */ }
.set-username-btn {
  background: none;
  border: none;
  color: #f59e0b; /* Orange warning */
  cursor: pointer;
  padding: 0;
  font-size: inherit;
}
.set-username-btn:hover { text-decoration: underline; }
.connection-warning { color: #f59e0b; }

/* --- Username Modal --- */
.modal-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(5px);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}
.username-modal {
  background: #1e222a;
  padding: 30px;
  border-radius: 10px;
  border: 1px solid #444;
  box-shadow: 0 5px 20px rgba(0,0,0,0.5);
  text-align: center;
  max-width: 400px;
}
.username-modal h3 { color: #eee; margin-bottom: 10px; }
.username-modal p { color: #aaa; margin-bottom: 20px; }
.username-input {
  width: 90%; /* Take most width */
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #555;
  border-radius: 5px;
  padding: 12px;
  font-size: 1.1em;
  color: #eee;
  margin-bottom: 10px;
}
.username-input:focus { border-color: #646cff; outline: none; }
.username-requirements { font-size: 0.8em; color: #777; margin-bottom: 20px; }
.modal-actions { /* Style button container if needed */ }
.save-username-btn {
  background: #646cff;
  color: white;
  border: none;
  border-radius: 5px;
  padding: 12px 25px;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.2s;
}
.save-username-btn:hover { background: #535bf2; }

/* --- Auth Required --- */
.auth-required-chat {
  flex-grow: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 40px;
}
.auth-prompt { max-width: 450px; color: #aaa; }
.auth-icon { font-size: 3em; margin-bottom: 15px; }
.auth-prompt h3 { color: #eee; margin-bottom: 10px; }
.auth-prompt p { margin-bottom: 25px; }
.auth-features { display: flex; flex-direction: column; gap: 8px; margin-top: 20px; font-size: 0.9em; color: #888; }
.feature { /* Style if needed */ }

/* Scrollbar styling (optional, browser-specific) */
.messages-container::-webkit-scrollbar { width: 6px; }
.messages-container::-webkit-scrollbar-track { background: transparent; }
.messages-container::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }
.messages-container::-webkit-scrollbar-thumb:hover { background: #555; }
